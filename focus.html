<<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Study Space</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --glass-bg: rgba(255, 255, 255, 0.1);
      --glass-border: rgba(255, 255, 255, 0.2);
      --primary-color: white;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', sans-serif;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      color: var(--primary-color);
      background-image: url('flocus.backgrounds/1.jpg');
      background-size: cover;
      background-position: center;
      transition: background-image 0.8s ease-in-out;
      overflow: hidden;
      position: relative;
    }

    body::after {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.3);
      z-index: -1;
    }

    /* --- GLASS --- */
    .glass-panel {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 30px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }

    /* --- CENTER CARD --- */
    .main-card {
      padding: 3rem 4rem;
      text-align: center;
      max-width: 600px;
      width: 90%;
      animation: slideUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
      position: relative;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .hidden { display: none !important; }

    /* --- NAME INPUT --- */
    .name-input-container h2 { font-weight: 300; margin-bottom: 1.5rem; }

    input[type="text"] {
      background: rgba(255,255,255,0.15);
      border: none;
      padding: 15px 20px;
      border-radius: 12px;
      color: white;
      font-size: 1.2rem;
      text-align: center;
      width: 100%;
      margin-bottom: 1.5rem;
      outline: none;
      transition: 0.3s;
    }
    input[type="text"]:focus { background: rgba(255,255,255,0.25); }
    input::placeholder { color: rgba(255,255,255,0.5); }

    .start-btn {
      background: white;
      color: #333;
      font-weight: 700;
      padding: 12px 30px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      font-size: 1rem;
      transition: 0.3s;
    }
    .start-btn:hover { transform: scale(1.05); }

    /* --- CLOCK / TIMER --- */
    .greeting { font-size: 1.5rem; font-weight: 400; margin-bottom: 0.5rem; opacity: 0.9; }
    .quote { font-size: 0.9rem; font-style: italic; opacity: 0.7; margin-bottom: 1.5rem; }

    .clock-display {
      font-size: 6rem;
      font-weight: 800;
      line-height: 1;
      margin-bottom: 1.5rem;
      text-shadow: 0 5px 15px rgba(0,0,0,0.2);
      font-variant-numeric: tabular-nums;
    }

    .controls-container { display: flex; flex-direction: column; gap: 15px; align-items: center; }
    .btn-group { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }

    .glass-btn {
      background: rgba(255, 255, 255, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.2);
      color: white;
      padding: 10px 20px;
      border-radius: 50px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 500;
      transition: 0.3s;
      user-select: none;
    }
    .glass-btn:hover { background: rgba(255, 255, 255, 0.3); }
    .active-mode { background: white; color: black; font-weight: 700; }

    /* --- PRESETS --- */
    .presets-group {
      display: flex;
      gap: 8px;
      margin-bottom: 5px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .preset-btn {
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.7);
      width: 40px; height: 40px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      font-size: 0.9rem;
      transition: all 0.2s;
      display: flex; align-items: center; justify-content: center;
      user-select: none;
    }
    .preset-btn:hover { background: rgba(255, 255, 255, 0.25); color: white; }
    .preset-btn.active-preset {
      background: white;
      color: black;
      border-color: white;
      transform: scale(1.1);
    }

    /* --- BOTTOM CONTROLS --- */
    .bottom-controls {
      position: absolute;
      bottom: 30px;
      width: 100%;
      padding: 0 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    /* --- MUSIC PANEL --- */
    .music-panel {
      position: absolute;
      bottom: 80px;
      left: 40px;
      padding: 10px;
      width: 320px;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: all 0.4s ease;
      z-index: 100;
    }
    .music-panel.show {
      opacity: 1;
      pointer-events: all;
      transform: translateY(0);
    }

    /* --- FOOTER SIGN --- */
    .footer-sign {
      position: absolute;
      bottom: 6px;
      left: 0;
      width: 100%;
      text-align: center;
      color: rgba(255,255,255,0.8);
      font-size: 0.85rem;
      letter-spacing: 0.4px;
      user-select: none;
      pointer-events: none;
    }

    @media (max-width: 640px) {
      .main-card { padding: 2rem 1.5rem; }
      .clock-display { font-size: 4.2rem; }
      .bottom-controls { padding: 0 16px; flex-direction: column; bottom: 40px; }
      .music-panel { left: 16px; width: calc(100% - 32px); }
    }
  </style>
</head>

<body>

  <!-- STEP 1: NAME -->
  <div class="glass-panel main-card name-input-container" id="nameStep">
    <h2>Welcome to your study space.</h2>
    <input type="text" id="nameInput" placeholder="What's your name?" autocomplete="off" />
    <button class="start-btn" id="startBtn">Let's Focus</button>
  </div>

  <!-- STEP 2: MAIN -->
  <div class="glass-panel main-card hidden" id="mainStep">
    <div class="greeting" id="greetingArea">Hello.</div>
    <div class="quote">"Focus on being productive instead of busy."</div>

    <div class="clock-display" id="mainDisplay">00:00</div>

    <div class="controls-container">
      <div class="btn-group">
        <button class="glass-btn active-mode" id="modeClockBtn">Clock üïí</button>
        <button class="glass-btn" id="modeTimerBtn">Pomodoro üçÖ</button>
      </div>

      <div class="presets-group hidden" id="presetsBlock">
        <button class="preset-btn active-preset" data-minutes="25">25</button>
        <button class="preset-btn" data-minutes="30">30</button>
        <button class="preset-btn" data-minutes="45">45</button>
        <button class="preset-btn" data-minutes="60">60</button>
      </div>

      <div class="btn-group hidden" id="timerControls">
        <button class="glass-btn" id="timerStartBtn">Start</button>
        <button class="glass-btn" id="timerResetBtn">Reset</button>
      </div>
    </div>
  </div>

  <!-- MUSIC PANEL (NO AUTOPLAY) -->
  <div class="glass-panel music-panel" id="musicPanel" style="padding: 0; overflow: hidden; height: 80px; display: flex; align-items: center;">
    <!-- iframe –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Play -->
    <div id="musicInner" style="width: 100%; height: 80px; display: flex; align-items: center; justify-content: center; padding: 10px; gap: 10px;">
      <button class="glass-btn" id="musicPlayBtn">‚ñ∂ Play</button>
      <button class="glass-btn hidden" id="musicStopBtn">‚èπ Stop</button>
      <div style="opacity:0.75; font-size:0.9rem;">ADHD Relief Music</div>
    </div>
  </div>

  <!-- BOTTOM CONTROLS -->
  <div class="bottom-controls">
    <div class="btn-group">
      <button class="glass-btn" id="backBtn">‚Üê Back</button>
      <button class="glass-btn" id="musicToggleBtn">üéµ Music</button>
    </div>

    <div class="btn-group">
      <button class="glass-btn" id="vibeBtn">Change Vibe ‚ú®</button>
      <button class="glass-btn" id="fsBtn">‚õ∂ Full Screen</button>
    </div>
  </div>

  <!-- SIGNATURE -->
  <div class="footer-sign">yauheniyadrozd/site</div>

  <script>
    // --- BACKGROUNDS ---
    const backgrounds = [
      'flocus.backgrounds/1.jpg',
      'flocus.backgrounds/2.jpg',
      'flocus.backgrounds/3.jpg',
      'flocus.backgrounds/4.jpg',
      'flocus.backgrounds/5.jpg',
    ];
    let bgIndex = 0;

    // --- STATE ---
    let userName = "Student";
    let currentMode = "clock";

    let clockIntervalId = null;
    let timerIntervalId = null;

    let selectedDuration = 25; // minutes
    let timeLeft = selectedDuration * 60; // seconds
    let isTimerRunning = false;

    // --- ELEMENTS ---
    const nameStep = document.getElementById("nameStep");
    const mainStep = document.getElementById("mainStep");
    const nameInput = document.getElementById("nameInput");

    const startBtn = document.getElementById("startBtn");
    const backBtn = document.getElementById("backBtn");

    const greetingArea = document.getElementById("greetingArea");
    const mainDisplay = document.getElementById("mainDisplay");

    const modeClockBtn = document.getElementById("modeClockBtn");
    const modeTimerBtn = document.getElementById("modeTimerBtn");

    const presetsBlock = document.getElementById("presetsBlock");
    const timerControls = document.getElementById("timerControls");
    const timerStartBtn = document.getElementById("timerStartBtn");
    const timerResetBtn = document.getElementById("timerResetBtn");

    const vibeBtn = document.getElementById("vibeBtn");
    const fsBtn = document.getElementById("fsBtn");

    // MUSIC
    const musicToggleBtn = document.getElementById("musicToggleBtn");
    const musicPanel = document.getElementById("musicPanel");
    const musicInner = document.getElementById("musicInner");
    const musicPlayBtn = document.getElementById("musicPlayBtn");
    const musicStopBtn = document.getElementById("musicStopBtn");

    const YT_SRC = "https://www.youtube.com/embed/uk-DSogtQRo?autoplay=1&controls=0&modestbranding=1&rel=0&iv_load_policy=3";

    // --- NAVIGATION ---
    function goToMain() {
      const name = nameInput.value.trim();
      if (name) userName = name;

      nameStep.classList.add("hidden");
      mainStep.classList.remove("hidden");

      startClockLoop();
      setMode("clock");
    }

    function goBack() {
      // stop timer
      stopTimer(true);

      // stop clock
      stopClockLoop();

      // close music + stop playback
      hideMusicPanel();
      stopMusic();

      // reset UI to name step
      mainStep.classList.add("hidden");
      nameStep.classList.remove("hidden");
      nameInput.focus();
    }

    // --- CLOCK ---
    function startClockLoop() {
      updateClock(); // immediate
      if (clockIntervalId) clearInterval(clockIntervalId);
      clockIntervalId = setInterval(updateClock, 1000);
    }

    function stopClockLoop() {
      if (clockIntervalId) clearInterval(clockIntervalId);
      clockIntervalId = null;
    }

    function updateClock() {
      const now = new Date();

      const hour = now.getHours();
      let timeGreeting = "Hello";
      if (hour < 12) timeGreeting = "Good morning";
      else if (hour < 18) timeGreeting = "Good afternoon";
      else timeGreeting = "Good evening";

      greetingArea.textContent = `${timeGreeting}, ${userName}.`;

      if (currentMode === "clock") {
        const h = String(now.getHours()).padStart(2, "0");
        const m = String(now.getMinutes()).padStart(2, "0");
        mainDisplay.textContent = `${h}:${m}`;
      }
    }

    // --- TIMER ---
    function formatTime(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${String(m).padStart(2, "0")}:${String(s).padStart(2, "0")}`;
    }

    function setDuration(minutes, btn) {
      // stop current timer (no reset of selectedDuration yet)
      stopTimer(true);

      selectedDuration = minutes;
      timeLeft = minutes * 60;
      mainDisplay.textContent = formatTime(timeLeft);

      document.querySelectorAll(".preset-btn").forEach(b => b.classList.remove("active-preset"));
      btn.classList.add("active-preset");
    }

    function setMode(mode) {
      currentMode = mode;

      if (mode === "clock") {
        modeClockBtn.classList.add("active-mode");
        modeTimerBtn.classList.remove("active-mode");

        presetsBlock.classList.add("hidden");
        timerControls.classList.add("hidden");

        // if timer was running, pause it (–Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Ä–µ–º—è)
        if (isTimerRunning) {
          stopTimer(false);
          timerStartBtn.textContent = "Resume";
        }

        updateClock();
      } else {
        modeClockBtn.classList.remove("active-mode");
        modeTimerBtn.classList.add("active-mode");

        presetsBlock.classList.remove("hidden");
        timerControls.classList.remove("hidden");

        mainDisplay.textContent = formatTime(timeLeft);
      }
    }

    function tickTimer() {
      if (timeLeft > 0) {
        timeLeft--;
        mainDisplay.textContent = formatTime(timeLeft);
        return;
      }
      // finish
      stopTimer(false);
      alert("Session finished!");
      resetTimer();
    }

    function startTimer() {
      if (timerIntervalId) clearInterval(timerIntervalId);
      timerIntervalId = setInterval(tickTimer, 1000);
      isTimerRunning = true;
      timerStartBtn.textContent = "Pause";
    }

    function stopTimer(resetButtonTextToStart) {
      if (timerIntervalId) clearInterval(timerIntervalId);
      timerIntervalId = null;
      isTimerRunning = false;
      if (resetButtonTextToStart) timerStartBtn.textContent = "Start";
    }

    function toggleTimer() {
      if (currentMode !== "timer") return;

      if (isTimerRunning) {
        stopTimer(false);
        timerStartBtn.textContent = "Resume";
      } else {
        startTimer();
      }
    }

    function resetTimer() {
      stopTimer(true);
      timeLeft = selectedDuration * 60;
      mainDisplay.textContent = formatTime(timeLeft);
    }

    // --- BACKGROUND ---
    function changeBackground() {
      bgIndex = (bgIndex + 1) % backgrounds.length;
      document.body.style.backgroundImage = `url('${backgrounds[bgIndex]}')`;
    }

    // --- FULLSCREEN ---
    function toggleFullScreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen?.();
      } else {
        document.exitFullscreen?.();
      }
    }

    // --- MUSIC (NO AUTOPLAY) ---
    function showMusicPanel() {
      musicPanel.classList.add("show");
    }

    function hideMusicPanel() {
      musicPanel.classList.remove("show");
    }

    function toggleMusicPanel() {
      musicPanel.classList.toggle("show");
    }

    function playMusic() {
      // if iframe already exists, do nothing
      if (musicInner.querySelector("iframe")) return;

      // create iframe on demand (user interaction -> autoplay allowed)
      const iframe = document.createElement("iframe");
      iframe.width = "100%";
      iframe.height = "80";
      iframe.src = YT_SRC;
      iframe.title = "ADHD Relief Music";
      iframe.frameBorder = "0";
      iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture";
      iframe.allowFullscreen = true;
      iframe.style.borderRadius = "12px";
      iframe.style.display = "block";
      iframe.style.marginTop = "-5px";

      // replace inner controls with iframe
      musicInner.innerHTML = "";
      musicInner.style.padding = "0";
      musicInner.appendChild(iframe);

      // show stop button state in panel header area not available now,
      // so we add a floating stop button inside panel
      const stopBtn = document.createElement("button");
      stopBtn.className = "glass-btn";
      stopBtn.textContent = "‚èπ Stop";
      stopBtn.style.position = "absolute";
      stopBtn.style.right = "12px";
      stopBtn.style.top = "12px";
      stopBtn.style.zIndex = "101";
      stopBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        stopMusic();
      });
      musicPanel.appendChild(stopBtn);
    }

    function stopMusic() {
      // remove iframe
      const iframe = musicInner.querySelector("iframe");
      if (iframe) iframe.remove();

      // remove floating stop buttons (if any)
      [...musicPanel.querySelectorAll("button.glass-btn")]
        .filter(b => b.textContent.includes("Stop") || b.textContent.includes("‚èπ"))
        .forEach(b => b.remove());

      // restore default controls
      musicInner.style.padding = "10px";
      musicInner.innerHTML = `
        <button class="glass-btn" id="musicPlayBtn">‚ñ∂ Play</button>
        <button class="glass-btn hidden" id="musicStopBtn">‚èπ Stop</button>
        <div style="opacity:0.75; font-size:0.9rem;">ADHD Relief Music</div>
      `;

      // re-bind restored play button
      const restoredPlay = document.getElementById("musicPlayBtn");
      restoredPlay.addEventListener("click", playMusic);
    }

    // --- EVENTS ---
    startBtn.addEventListener("click", goToMain);
    backBtn.addEventListener("click", goBack);

    modeClockBtn.addEventListener("click", () => setMode("clock"));
    modeTimerBtn.addEventListener("click", () => setMode("timer"));

    document.querySelectorAll(".preset-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        const mins = Number(btn.dataset.minutes);
        setDuration(mins, btn);
      });
    });

    timerStartBtn.addEventListener("click", toggleTimer);
    timerResetBtn.addEventListener("click", resetTimer);

    vibeBtn.addEventListener("click", changeBackground);
    fsBtn.addEventListener("click", toggleFullScreen);

    musicToggleBtn.addEventListener("click", toggleMusicPanel);

    // Play/Stop in initial panel controls
    musicPlayBtn.addEventListener("click", playMusic);
    musicStopBtn.addEventListener("click", stopMusic);

    nameInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") goToMain();
    });

    // initial focus
    nameInput.focus();
  </script>
</body>
</html>
